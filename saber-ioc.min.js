/* @license saber2pr @see https://github.com/Saber2pr/saber-ioc */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).sioc=t()}(this,function(){"use strict";var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.reflect=Reflect});e(n);n.reflect;var r=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.decorate=function(e,t,a,n){if(0===e.length)throw new TypeError;return e.reduceRight(function(e,t){return t(e,a,n)||e},t)}});e(r);r.decorate;var c=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTKAY="reflect:default"});e(c);c.DEFAULTKAY;var o=t(function(e,f){Object.defineProperty(f,"__esModule",{value:!0}),f.Metadata=new WeakMap,f.defineMetadata=function(e,t,a,n){if(void 0===n&&(n=c.DEFAULTKAY),"object"!=typeof a&&"function"!=typeof a)throw new TypeError;if(n&&!["string","symbol"].includes(typeof n))throw new TypeError;var r=f.Metadata.get(a)||new Map;f.Metadata.set(a,r);var o=r.get(n)||new Map;r.set(n,o),o.set(e,t)}});e(o);o.Metadata,o.defineMetadata;var f=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getOwnMetadataMap=function(e,t){if(void 0===t&&(t=c.DEFAULTKAY),"object"!=typeof e&&"function"!=typeof e)throw new TypeError;var a=o.Metadata.get(e);if(a){var n=a.get(t);if(n)return n}}});e(f);f.getOwnMetadataMap;var i=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.deleteMetadata=function(e,t,a){var n=f.getOwnMetadataMap(t,a);return!!n&&n.delete(e)}});e(i);i.deleteMetadata;var d=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMetadataMap=function(e,t){if(void 0===t&&(t=c.DEFAULTKAY),Boolean(f.getOwnMetadataMap(e,t)))return f.getOwnMetadataMap(e,t);var a=o.Metadata.get(Object.getPrototypeOf(e));if(a){var n=a.get(t);if(n)return n}}});e(d);d.getMetadataMap;var u=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMetadata=function(e,t,a){var n=d.getMetadataMap(t,a);if(n)return n.get(e)},t.getOwnMetadata=function(e,t,a){var n=f.getOwnMetadataMap(t,a);if(n)return n.get(e)}});e(u);u.getMetadata,u.getOwnMetadata;var l=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getOwnMetadataKeys=function(e,t){var a=[],n=f.getOwnMetadataMap(e,t);return n?(a.push.apply(a,Array.from(n.keys())),[].concat.apply([],a)):a}});e(l);l.getOwnMetadataKeys;var s=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMetadataKeys=function(e,t){var a=l.getOwnMetadataKeys(e,t),n=l.getOwnMetadataKeys(Object.getPrototypeOf(e),t);return[].concat.apply([],a.concat(n))}});e(s);s.getMetadataKeys;var p=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.hasMetadata=function(e,t,a){return s.getMetadataKeys(t,a).includes(e)}});e(p);p.hasMetadata;var M=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.hasOwnMetadata=function(e,t,a){return l.getOwnMetadataKeys(t,a).includes(e)}});e(M);M.hasOwnMetadata;var y=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.metadata=function(a,n){return function(e,t){return o.defineMetadata(a,n,e,t)}}});e(y);y.metadata;var v=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Reflector={decorate:r.decorate,defineMetadata:o.defineMetadata,deleteMetadata:i.deleteMetadata,getMetadata:u.getMetadata,getMetadataKeys:s.getMetadataKeys,getOwnMetadata:u.getOwnMetadata,getOwnMetadataKeys:l.getOwnMetadataKeys,hasMetadata:p.hasMetadata,hasOwnMetadata:M.hasOwnMetadata,metadata:y.metadata},t.Reflect=Object.assign(n.reflect,t.Reflector)});e(v);v.Reflector,v.Reflect;var g=t(function(e,a){Object.defineProperty(a,"__esModule",{value:!0}),function(e){for(var t in e)a.hasOwnProperty(t)||(a[t]=e[t])}(v)});e(g);var O=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MetaStore={}});e(O);O.MetaStore;var _=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BASETYPES=["Number","String","Boolean","undefined","Array"],t.MetaKey=function(e){return"saber_meta:"+e}});e(_);_.BASETYPES,_.MetaKey;var b=t(function(e,t){var o;function f(e){if(_.BASETYPES.includes(g.Reflect.get(e,"name")))throw new Error("the param of class["+g.Reflect.getMetadata("saber_visited",O.MetaStore)+"]'s constructor has invalid type: "+e.name);g.Reflect.defineMetadata("saber_visited",e.name,O.MetaStore)}Object.defineProperty(t,"__esModule",{value:!0}),(o=t.Class||(t.Class={})).isStatic=function(e){return g.Reflect.hasMetadata("saber_static",e)},t.TypeCheck=f,t.ParamCheck=function(n,e){var r=g.Reflect.get(n,e);return g.Reflect.set(n,e,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a=e[0];return o.isStatic(a)?a:(f(a),r.apply(n,e))}),r}});e(b);b.Class,b.TypeCheck,b.ParamCheck;var w=t(function(e,t){var c=a&&a.__decorate||function(e,t,a,n){var r,o=arguments.length,f=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;0<=c;c--)(r=e[c])&&(f=(o<3?r(f):3<o?r(t,a,f):r(t,a))||f);return 3<o&&f&&Object.defineProperty(t,a,f),f},i=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t,n=(a.create=function(n){var t=this,r=[];g.Reflect.hasMetadata("design:paramtypes",n)&&g.Reflect.getMetadata("design:paramtypes",n).forEach(function(e,t){"Object"!==g.Reflect.get(e,"name")&&(r[t]=e)}),g.Reflect.getMetadataKeys(n).filter(function(e){return-1!==e.indexOf("saber_meta")}).forEach(function(e){if(!g.Reflect.hasMetadata(e,O.MetaStore))throw new Error("cannot found "+e.replace("saber_meta","dependence")+" in container.");var t=g.Reflect.getMetadata(e,n),a=g.Reflect.getMetadata(e,O.MetaStore);r[t]=a});var e=r.map(function(e){return t.create(e)});return new(n.bind.apply(n,[void 0].concat(e)))},c([b.ParamCheck,i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype","function"==typeof(t="undefined"!=typeof T&&T)?t:Object)],a,"create",null),a);function a(){}function r(e,t){var a=n.create(e);g.Reflect.has(e.prototype,"main")?g.Reflect.get(e.prototype,"main").apply(a):g.Reflect.get(e.prototype,t||g.Reflect.ownKeys(e.prototype)[1]).apply(a)}e.Factory=n,e.BootStrap=r;var o=(f.prototype.pull=function(){return n.create(this.main)},f.prototype.run=function(e){r(e||this.main)},f);function f(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.main=e.find(function(e){return g.Reflect.hasMetadata("saber_main",e)})||e[0]}e.Container=o}(t.SaIOC||(t.SaIOC={}))});e(w);w.SaIOC;var h=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Injectable=function(t){return function(e){if(g.Reflect.hasMetadata(_.MetaKey(t),O.MetaStore))throw new Error("id:["+t+"] is existed!");g.Reflect.defineMetadata(_.MetaKey(t||g.Reflect.get(e,"name")),e,O.MetaStore)}},t.Inject=function(n){return function(e,t,a){return g.Reflect.defineMetadata(_.MetaKey(n),a,e)}},t.Bootstrap=function(e){g.Reflect.defineMetadata("saber_main",void 0,e)},t.Singleton=function(e){g.Reflect.defineMetadata("saber_static",void 0,e)},t.Static=function(e){g.Reflect.defineMetadata("saber_static",void 0,e)}});e(h);h.Injectable,h.Inject,h.Bootstrap,h.Singleton,h.Static;return e(t(function(e,a){function t(e){for(var t in e)a.hasOwnProperty(t)||(a[t]=e[t])}Object.defineProperty(a,"__esModule",{value:!0}),t(w),t(h)}))});
